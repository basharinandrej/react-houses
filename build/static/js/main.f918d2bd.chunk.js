(this.webpackJsonphouses=this.webpackJsonphouses||[]).push([[0],{41:function(e,n,t){},45:function(e,n,t){},47:function(e,n,t){},48:function(e,n,t){},54:function(e,n,t){},58:function(e,n,t){},59:function(e,n,t){},60:function(e,n,t){},61:function(e,n,t){},62:function(e,n,t){},63:function(e,n,t){"use strict";t.r(n);var r=t(4),a=(t(41),t(28)),c=t.n(a),i=t(17),o=t(18),s=t(21),u=t(20),l=(t(45),t(22)),d=(t(47),t(48),t(5)),p=function(e){var n=["indicator"];return"object"===typeof e.stateIndicator&&n.push("indicator--success"),Object(d.jsx)("span",{className:"".concat(n.join(" "))})},v=function(e){var n,t=e.place,r=e.renderLists,a=e.placesItems,c=e.allPlaceIdWithHasInventory,i=(null===c||void 0===c?void 0:c.includes(t.id))&&a.find((function(e){return e.id===t.id?e:null}));return Object(d.jsxs)("li",{className:"aside-list__item",children:[Object(d.jsxs)("p",{className:"aside-list__paragraph",id:t.id,children:[null===(n=t.data)||void 0===n?void 0:n.name,Object(d.jsx)(p,{stateIndicator:i})]}),t.parts?r(t.parts):null]})},f=t(19),h=function(e){Object(s.a)(t,e);var n=Object(u.a)(t);function t(){return Object(i.a)(this,t),n.apply(this,arguments)}return Object(o.a)(t,[{key:"render",value:function(){var e=this;return Object(d.jsx)("ul",{className:"aside-list",onClick:function(n){return e.props.onClickPlaceHandler.call(e.props.context,n)},children:this.props.places.map((function(n){if(e.props.housesId.includes(n.id))return Object(d.jsx)(v,{place:n,renderLists:e.props.renderLists,placesItems:e.props.places,allPlaceIdWithHasInventory:e.props.allPlaceIdWithHasInventory},n.id)}))})}}]),t}(r.Component),j=Object(f.b)((function(e){return{allPlaceIdWithHasInventory:e.inventory.allPlaceIdWithHasInventory}}))(h),I=(t(54),t(11)),b=t.n(I),y=t(30),O=t(26),m=O.a.initializeApp({apiKey:"AIzaSyD6DnGbVfdJlDJ_pEOUfDfTDJrA8j3lIs8",authDomain:"dv-inventory.firebaseapp.com",databaseURL:"https://dv-inventory.firebaseio.com",projectId:"dv-inventory",storageBucket:"dv-inventory.appspot.com",messagingSenderId:"130062240176",appId:"1:130062240176:web:ecbca5d29b37d25c6cee75"}),_="START_FETCH_PLACES",P="SUCCESS_FETCH_PLACES",x="ERROR_FETCH_PLACES",E="START_FETCH_INVENTORY",C="SUCCESS_FETCH_INVENTORY",N="ERROR_FETCH_INVENTORY",H="REMOVE_INVENTORY_ITEM",w="ADD_INVENTORY_ITEM",g="UPDATE_INVENTORY_ITEM",k="SET_CURRENT_INVENTORY",T="SET_CURRENT_PLACE",L="SET_CHILDREN_PLACE_WITH_HAS_INVENTORY",A="SET_INVENTORY_PLACE_CHILDREN",S="ALL_PLACE_ID_WITH_HAS_INVENTORY",R=function(){return{type:_}},D=function(e){return{type:P,placesItems:e}},V=function(e){return{type:x,error:e}},W=function(e){return{type:C,inventoryItems:e}},U=function(e){return{type:N,error:e}},Y=function(e){return{type:k,placeId:e}},M=function(e,n){return{type:A,inventoryItems:e,childrenPlaceHasInventoryArray:n}},F=function(e){return{type:H,id:e}},J=function(e){Object(s.a)(t,e);var n=Object(u.a)(t);function t(){return Object(i.a)(this,t),n.apply(this,arguments)}return Object(o.a)(t,[{key:"componentDidMount",value:function(){this.props.fetchPlaces(),this.props.fetchInventory()}},{key:"onClickPlaceHandler",value:function(e){e.stopPropagation();var n=e.target;""!==n.id&&(this.props.setCurrentPlace(n.id),this.props.setInventoryCurrentPlace(n.id),this.props.setPlaceChildrenHasInventory(this.props.allPlaceIdWithHasInventory))}},{key:"getIdParts",value:function(){var e=this.props.places.filter((function(e){return e.parts})).map((function(e){return e.parts}));return Object(l.flattenDeep)(e)}},{key:"renderListHouses",value:function(){var e=this,n=this.props.places.map((function(e){return e.id})),t=this.getIdParts();return function n(t){return Object(d.jsx)(j,{places:e.props.places,housesId:t,renderLists:n,onClickPlaceHandler:e.onClickPlaceHandler,context:e})}(Object(l.difference)(n,t))}},{key:"render",value:function(){return Object(d.jsx)("aside",{className:"main-aside",children:!this.props.isLoading&&this.renderListHouses()})}}]),t}(r.Component),X=Object(f.b)((function(e){return{places:e.places.placesItems,isLoading:e.places.isLoading,allPlaceIdWithHasInventory:e.inventory.allPlaceIdWithHasInventory,childrenPlaceHasInventoryArray:e.places.childrenPlaceHasInventoryArray}}),(function(e){return{fetchPlaces:function(){return e(function(){var e=Object(y.a)(b.a.mark((function e(n){var t,r;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n(R()),e.prev=1,e.next=4,m.firestore().collection("places").get();case 4:t=e.sent,r=t.docs.map((function(e){return{id:e.id,data:e.data(),parts:e.data().parts&&e.data().parts.map((function(e){return e.id}))}})),n(D(r)),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),n(V(e.t0));case 12:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(n){return e.apply(this,arguments)}}())},fetchInventory:function(){return e(function(){var e=Object(y.a)(b.a.mark((function e(n){var t,r;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,m.firestore().collection("inventory").get();case 3:t=e.sent,r=t.docs.map((function(e){var n;return{id:e.id,data:e.data(),placeId:null===(n=e.data().place)||void 0===n?void 0:n.id}})),console.log("inventoryItems",r),n(W(r)),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),n(U(e.t0));case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(n){return e.apply(this,arguments)}}())},setCurrentPlace:function(n){return e(function(e){return{type:T,placeId:e}}(n))},setInventoryCurrentPlace:function(n){return e(Y(n))},setPlaceChildrenHasInventory:function(n){return e(function(e){return{type:L,allPlaceIdWithHasInventory:e}}(n))}}}))(J),z=(t(58),t(59),function(e){Object(s.a)(t,e);var n=Object(u.a)(t);function t(){return Object(i.a)(this,t),n.apply(this,arguments)}return Object(o.a)(t,[{key:"render",value:function(){return Object(d.jsx)("ul",{className:"list-main",children:this.props.childrenInventory.map((function(e){return Object(d.jsx)("li",{className:"list-main__item",children:Object(d.jsxs)("p",{className:"list-main__paragraph",children:[e.data.name," - ",e.data.count," - \u0448\u0442."]})},e.id)}))})}}]),t}(r.Component)),B=Object(f.b)(null,(function(e){return{removeInventoryItem:function(n){return e(F(n))}}}))(z),q=function(e){Object(s.a)(t,e);var n=Object(u.a)(t);function t(){return Object(i.a)(this,t),n.apply(this,arguments)}return Object(o.a)(t,[{key:"render",value:function(){var e,n=this;return Object(d.jsx)(d.Fragment,{children:null===(e=this.props.childrenPlaceHasInventoryArray)||void 0===e?void 0:e.map((function(e){if(!e.parts)return Object(d.jsxs)("div",{className:"main__wrapper",children:[Object(d.jsx)("h2",{className:"main__title title",children:e.data.name}),Object(d.jsx)(B,{childrenInventory:n.props.childrenInventory,childrenPlaceId:e.id})]},e.id)}))})}}]),t}(r.Component),G=Object(f.b)((function(e){return{childrenPlaceHasInventoryArray:e.places.childrenPlaceHasInventoryArray,childrenInventory:e.inventory.childrenInventory}}))(q),K=(t(60),t(61),function(e){Object(s.a)(t,e);var n=Object(u.a)(t);function t(){return Object(i.a)(this,t),n.apply(this,arguments)}return Object(o.a)(t,[{key:"removeInventoryHandler",value:function(e,n){window.confirm("\u0412\u044b \u0445\u043e\u0442\u0438\u0442\u0435 \u0443\u0434\u0430\u043b\u0438\u0442\u044c ".concat(e))&&this.props.removeInventoryItem(n)}},{key:"editInventoryHandler",value:function(e){this.props.editInventoryItem(e,this.props.idCurrentPlace)}},{key:"render",value:function(){var e=this;return Object(d.jsx)("ul",{className:"list-main",children:this.props.contentIteration.map((function(n){return Object(d.jsxs)("li",{className:"list-main__item",children:[Object(d.jsxs)("p",{className:"list-main__paragraph",children:[n.data.name," - ",n.data.count," - \u0448\u0442."]}),Object(d.jsxs)("div",{className:"list-main__wrapper",children:[Object(d.jsx)("p",{className:"list-main__paragraph list-main__paragraph--remove",onClick:function(){return e.removeInventoryHandler(n.data.name,n.id)},children:"\u0423\u0434\u0430\u043b\u0438\u0442\u044c"}),Object(d.jsx)("span",{className:"list-main__separator",children:"/"}),Object(d.jsx)("p",{className:"list-main__paragraph list-main__paragraph--edit",onClick:function(){return e.editInventoryHandler(n.id)},children:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c"})]})]},n.id)}))})}}]),t}(r.Component)),Q=Object(f.b)((function(e){return{idCurrentPlace:e.places.currentPlace.id}}),(function(e){return{removeInventoryItem:function(n){return e(F(n))},editInventoryItem:function(n,t){return e(function(e,n){return{type:g,id:e,idCurrentPlace:n}}(n,t))}}}))(K),Z=(t(62),function(e){var n=e.children,t=e.onClick;return Object(d.jsx)("button",{onClick:t,className:"button",children:n})}),$=function(e){Object(s.a)(t,e);var n=Object(u.a)(t);function t(){var e;Object(i.a)(this,t);for(var r=arguments.length,a=new Array(r),c=0;c<r;c++)a[c]=arguments[c];return(e=n.call.apply(n,[this].concat(a))).hasNotChildrenPlace=function(){var n,t;return!(null===(n=e.props.currentPlace)||void 0===n||null===(t=n.parts)||void 0===t?void 0:t.length)},e.hasCurrentInventory=function(){var n;return null===(n=e.props.currentInventory)||void 0===n?void 0:n.length},e.hasCurrentPlace=function(){return e.props.currentPlace},e.addInventoryItemHandler=function(){var n;return e.props.addInventoryItem(null===(n=e.props.currentPlace)||void 0===n?void 0:n.id,e.props.places)},e}return Object(o.a)(t,[{key:"render",value:function(){var e,n;return Object(d.jsx)("main",{className:"main",children:Object(d.jsx)("div",{className:"container",children:!this.props.isLoading&&Object(d.jsxs)(d.Fragment,{children:[Object(d.jsx)("h1",{className:"main__title title",children:null===(e=this.props.currentPlace)||void 0===e?void 0:e.data.name}),this.hasCurrentInventory()?Object(d.jsx)(Q,{contentIteration:this.props.currentInventory}):0===(null===(n=this.props.childrenPlaceHasInventoryArray)||void 0===n?void 0:n.length)?Object(d.jsx)("p",{className:"main__paragraph",children:"\u041d\u0435\u0442 \u041e\u0431\u043e\u0440\u0443\u0434\u043e\u0432\u0430\u043d\u0438\u044f"}):null,this.hasNotChildrenPlace()&&this.hasCurrentPlace()&&Object(d.jsx)(Z,{onClick:this.addInventoryItemHandler.bind(this),children:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0438\u043d\u0432\u0435\u043d\u0442\u0430\u0440\u044c"}),Object(d.jsx)(G,{})]})})})}}]),t}(r.Component),ee=Object(f.b)((function(e){return{places:e.places.placesItems,currentPlace:e.places.currentPlace,isLoading:e.inventory.isLoading,currentInventory:e.inventory.currentInventory,childrenPlaceHasInventoryArray:e.places.childrenPlaceHasInventoryArray}}),(function(e){return{addInventoryItem:function(n,t){return e(function(e,n){return{type:w,placeId:e,placesItems:n}}(n,t))}}}))($),ne=function(e){Object(s.a)(t,e);var n=Object(u.a)(t);function t(){return Object(i.a)(this,t),n.apply(this,arguments)}return Object(o.a)(t,[{key:"render",value:function(){return Object(d.jsxs)("section",{className:"section-app",children:[Object(d.jsx)(X,{}),Object(d.jsx)(ee,{})]})}}]),t}(r.Component),te=t(24),re=t(14),ae=t(10),ce=function(e,n){return e.find((function(e){return e.id===n}))},ie=function(e,n){var t=null===e||void 0===e?void 0:e.map((function(e){return e.placeId})),r=function e(n,r){null===r||void 0===r||r.find((function(a){var c;(null===(c=a.parts)||void 0===c?void 0:c.includes(n))&&(t.push(a.id),e(a.id,r))}))};return t.map((function(e){return r(e,n)})),Object(l.uniq)(t)},oe=function(e,n){var t,r=e.currentPlace,a=e.placesItems,c=[];null===(t=r.parts)||void 0===t||t.forEach((function(e){c.push(e),a.forEach((function(n){n.id===e&&n.parts&&c.push(n.parts)}))})),c=Object(l.flattenDeep)(c);for(var i=Object(l.intersection)(n,c),o=[],s=function(e){a.find((function(n){n.id===i[e]&&o.push(n)}))},u=0;u<i.length;u++)s(u);return o},se={placesItems:[],childrenPlaceHasInventoryArray:null,isLoading:!0,currentPlace:null,error:null},ue=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:se,n=arguments.length>1?arguments[1]:void 0;switch(n.type){case _:return{isLoading:!0};case P:return Object(ae.a)(Object(ae.a)({},e),{},{isLoading:!1,placesItems:n.placesItems});case x:return{isLoading:!1,error:n.error};case T:return Object(ae.a)(Object(ae.a)({},e),{},{currentPlace:ce(Object(re.a)(e.placesItems),n.placeId)});case L:return Object(ae.a)(Object(ae.a)({},e),{},{childrenPlaceHasInventoryArray:oe(Object(ae.a)({},e),n.allPlaceIdWithHasInventory)})}return e},le=function(e,n){return e.filter((function(e){return e.placeId===n?e.data:null}))},de=function(e,n){var t=[];n.forEach((function(e){t.push(e.id)}));var r=[];return t.forEach((function(n){e.find((function(e){e.placeId===n&&r.push(e)}))})),r},pe=function(e,n){return function(e){O.a.firestore().collection("inventory").doc(e).delete().then((function(){console.info("Success Delete Inventory Item")}))}(n),e.filter((function(e){return e.id!==n}))},ve=function(e,n){var t=window.prompt("\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u043f\u0440\u0435\u0434\u043c\u0435\u0442\u0430"),r=window.prompt("\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043a\u043e\u043b-\u0432\u043e \u043f\u0440\u0435\u0434\u043c\u0435\u0442\u043e\u0432","1"),a={id:Math.random().toString(),placeId:n,data:{name:t,count:r,place:e}};return function(e){var n=e.placeId,t=e.data,r=t.name,a=t.count,c=O.a.firestore();c.collection("inventory").doc().set({name:r,count:a,place:c.collection("places").doc(n)}).then((function(){console.info("Success Add Inventory Item")}))}(a),a},fe=function(e,n,t){var r=window.prompt("\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043d\u043e\u0432\u043e\u0435 \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u043f\u0440\u0435\u0434\u043c\u0435\u0442\u0430"),a=window.prompt("\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043d\u043e\u0432\u043e\u0435 \u043a\u043e\u043b-\u0432\u043e \u043f\u0440\u0435\u0434\u043c\u0435\u0442\u043e\u0432","2");return e.map((function(e){if(e.id!==n)return e;e.data.name=r,e.data.count=a})),function(e,n,t,r){var a=O.a.firestore();O.a.firestore().collection("inventory").doc(e).set({name:n,count:t,place:a.collection("places").doc(r)}).then((function(){console.info("Success Update Inventory Item")}))}(n,r,a,t),e},he={inventoryItems:[],currentInventory:null,childrenInventory:null,allPlaceIdWithHasInventory:null,isLoading:!0,error:null},je=function(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:he,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case E:return Object(ae.a)(Object(ae.a)({},n),{},{isLoading:!0});case C:return Object(ae.a)(Object(ae.a)({},n),{},{isLoading:!1,inventoryItems:t.inventoryItems});case N:return Object(ae.a)(Object(ae.a)({},n),{},{isLoading:!1,error:t.error});case k:return Object(ae.a)(Object(ae.a)({},n),{},{currentInventory:le(Object(re.a)(n.inventoryItems),t.placeId)});case S:return Object(ae.a)(Object(ae.a)({},n),{},{allPlaceIdWithHasInventory:ie(Object(re.a)(n.inventoryItems),t.placesItems)});case A:return Object(ae.a)(Object(ae.a)({},n),{},{childrenInventory:de(t.inventoryItems,t.childrenPlaceHasInventoryArray)});case H:return Object(ae.a)(Object(ae.a)({},n),{},{inventoryItems:pe(Object(re.a)(n.inventoryItems),t.id),currentInventory:pe(Object(re.a)(n.currentInventory),t.id),childrenInventory:pe(Object(re.a)(n.childrenInventory),t.id)});case w:var r=null===(e=n.inventoryItems[0])||void 0===e?void 0:e.data.place,a=ve(r,t.placeId);return Object(ae.a)(Object(ae.a)({},n),{},{inventoryItems:[].concat(Object(re.a)(n.inventoryItems),[a]),currentInventory:[].concat(Object(re.a)(n.currentInventory),[a])});case g:var c=Object(re.a)(n.inventoryItems);return Object(ae.a)(Object(ae.a)({},n),{},{inventoryItems:fe(c,t.id,t.idCurrentPlace)})}return n},Ie=(0,t(24).combineReducers)({places:ue,inventory:je}),be=t(38),ye=t(39),Oe=t(16),me=b.a.mark(Le),_e=b.a.mark(Ae),Pe=b.a.mark(Se),xe=b.a.mark(Re),Ee=b.a.mark(De),Ce=b.a.mark(Ve),Ne=b.a.mark(We),He=b.a.mark(Ue),we=function(e){return Object(re.a)(e.places.placesItems)},ge=function(e){return Object(re.a)(e.inventory.inventoryItems)},ke=function(e){return Object(re.a)(e.places.childrenPlaceHasInventoryArray)},Te=function(e){return Object(re.a)(e.places.currentPlace.id)};function Le(){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Oe.d)(C,Re);case 2:case"end":return e.stop()}}),me)}function Ae(){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Oe.d)(w,Re);case 2:case"end":return e.stop()}}),_e)}function Se(){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Oe.d)(H,Re);case 2:case"end":return e.stop()}}),Pe)}function Re(){var e;return b.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Object(Oe.c)(we);case 2:return e=n.sent,n.next=5,Object(Oe.b)({type:S,placesItems:e});case 5:case"end":return n.stop()}}),xe)}function De(){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Oe.d)(L,Ve);case 2:case"end":return e.stop()}}),Ee)}function Ve(){var e,n;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(Oe.c)(ge);case 2:return e=t.sent,t.next=5,Object(Oe.c)(ke);case 5:return n=t.sent,t.next=8,Object(Oe.b)(M(e,n));case 8:case"end":return t.stop()}}),Ce)}function We(){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Oe.d)(g,Ue);case 2:case"end":return e.stop()}}),Ne)}function Ue(){var e;return b.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Object(Oe.c)(Te);case 2:return e=n.sent,n.next=5,Object(Oe.b)(Y(e.join("")));case 5:case"end":return n.stop()}}),He)}var Ye=b.a.mark(Me);function Me(){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Oe.a)([Le(),Ae(),Se(),De(),We()]);case 2:case"end":return e.stop()}}),Ye)}var Fe=Object(ye.a)(),Je="object"===typeof window&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__({}):te.compose,Xe=Object(te.createStore)(Ie,Je(Object(te.applyMiddleware)(be.a,Fe)));Fe.run(Me);var ze=Object(d.jsx)(f.a,{store:Xe,children:Object(d.jsx)(ne,{})});c.a.render(ze,document.getElementById("root"))}},[[63,1,2]]]);
//# sourceMappingURL=main.f918d2bd.chunk.js.map